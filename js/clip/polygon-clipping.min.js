!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["polygon-clipping"]=e():t["polygon-clipping"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=11)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Number.EPSILON;void 0===r&&(r=Math.pow(2,-52));var i=r*r;e.cmp=function(t,e){return-r<t&&t<r&&-r<e&&e<r?0:(t-e)*(t-e)<i*t*e?0:t<e?-1:1},e.cmpPoints=function(t,e){if(t===e)return 0;var n=t.x,o=e.x;if(n<=-r||r<=n||o<=-r||r<=o){var u=n-o;if(u*u>=i*n*o)return n<o?-1:1}if(n=t.y,o=e.y,n<=-r||r<=n||o<=-r||r<=o){var l=n-o;if(l*l>=i*n*o)return n<o?-1:1}return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),o=n(2);var u=0,l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n,this.id=++u}return r(t,null,[{key:"compare",value:function(t,e){if(t.point!==e.point){var n=(0,i.cmp)(t.point.x,e.point.x);if(0!==n)return n;var r=(0,i.cmp)(t.point.y,e.point.y);if(0!==r)return r;t.link(e)}if(t.isLeft!==e.isLeft)return t.isLeft?1:-1;if(t===e)return 0;for(var o=t,u=e;o.consumedBy;)o=o.consumedBy;for(;u.consumedBy;)u=u.consumedBy;if(o!==u){var l=t.segment.isVertical(),s=e.segment.isVertical();if(l&&!s)return t.isLeft?1:-1;if(!l&&s)return t.isLeft?-1:1;var f=t.segment.comparePoint(e.otherSE.point);if(1===f)return-1;if(-1===f)return 1;var a=e.segment.comparePoint(t.otherSE.point);if(0!==a)return a}if(t.id<e.id)return-1;if(t.id>e.id)return 1;throw new Error("SweepEvent comparison failed at ["+t.point.x+", "+t.point.y+"]")}}]),r(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=this.point.events.length,n=t.point.events,r=0,i=n.length;r<i;r++){var o=n[r];this.point.events.push(o),o.point=this.point;for(var u=0,l=e;u<l;u++)this.point.events[u].otherSE.point===o.otherSE.point&&this.point.events[u].segment.consume(o.segment)}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i=r.otherSE;n.set(r,{sine:(0,o.sineOfAngle)(e.point,t.point,i.point),cosine:(0,o.cosineOfAngle)(e.point,t.point,i.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var o=n.get(t),u=o.sine,l=o.cosine,s=n.get(e),f=s.sine,a=s.cosine,h=(0,i.cmp)(u,0),c=(0,i.cmp)(f,0);return h>=0&&c>=0?(0,i.cmp)(a,l):h<0&&c<0?(0,i.cmp)(l,a):(0,i.cmp)(f,u)}}}]),t}();e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.perpendicular=e.intersection=e.verticalIntersection=e.horizontalIntersection=e.cosineOfAngle=e.sineOfAngle=e.length=e.compareVectorAngles=e.dotProduct=e.crossProduct=void 0;var r=n(0),i=e.crossProduct=function(t,e){return t.x*e.y-t.y*e.x},o=e.dotProduct=function(t,e){return t.x*e.x+t.y*e.y},u=(e.compareVectorAngles=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},u={x:n.x-t.x,y:n.y-t.y},l=i(o,u);return(0,r.cmp)(l,0)},e.length=function(t){return Math.sqrt(o(t,t))}),l=(e.sineOfAngle=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return i(o,r)/u(o)/u(r)},e.cosineOfAngle=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return o(i,r)/u(i)/u(r)},e.horizontalIntersection=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}}),s=e.verticalIntersection=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}};e.intersection=function(t,e,n,r){if(0===e.x)return s(n,r,t.x);if(0===r.x)return s(t,e,n.x);if(0===e.y)return l(n,r,t.y);if(0===r.y)return l(t,e,n.y);var o=i(e,r);if(0==o)return null;var u={x:n.x-t.x,y:n.y-t.y},f=i(u,e)/o,a=i(u,r)/o;return{x:(t.x+a*e.x+(n.x+f*r.x))/2,y:(t.y+a*e.y+(n.y+f*r.y))/2}},e.perpendicular=function(t){return{x:-t.y,y:t.x}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=f(n(5)),o=f(n(1)),u=n(8),l=n(0),s=n(2);function f(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.ringsIn=r,this._cache={}}return r(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=t.leftSE.point.y,i=e.leftSE.point.x,o=e.leftSE.point.y,u=t.rightSE.point.x,s=e.rightSE.point.x;if((0,l.cmp)(s,n)<0)return 1;if((0,l.cmp)(u,i)<0)return-1;for(var f=t,a=e;f.consumedBy;)f=f.consumedBy;for(;a.consumedBy;)a=a.consumedBy;var h=void 0,c=void 0,p=void 0,v=void 0;if(f===a){if(t===e)return 0;var g=t.leftSE.id,y=e.leftSE.id;if(g<y)return-1;if(g>y)return 1}else if(0===(h=t.comparePoint(e.leftSE.point))&&0===(c=t.comparePoint(e.rightSE.point))&&0===(p=e.comparePoint(t.leftSE.point))&&0===(v=e.comparePoint(t.rightSE.point))){var d=(0,l.cmp)(n,i);if(0!==d)return d;var m=t.leftSE.id,x=e.leftSE.id;if(m<x)return-1;if(m>x)return 1}else{var _=(0,l.cmp)(n,i);if(_<0){if(1===h)return-1;if(-1===h)return 1}if(_>0&&(void 0===p&&(p=e.comparePoint(t.leftSE.point)),0!==p))return p;var E=(0,l.cmp)(r,o);if(0!==E)return E;var k=t.isVertical();if(k!==e.isVertical())return k?1:-1;if(void 0===c&&(c=t.comparePoint(e.rightSE.point)),c>0)return-1;if(c<0)return 1;if(void 0===v&&(v=e.comparePoint(t.rightSE.point)),v>0)return 1;if(v<0)return-1}throw new Error("Segment comparison of ["+t.leftSE.point.x+", "+t.leftSE.point.y+"] -> ["+t.rightSE.point.x+", "+t.rightSE.point.y+"] against ["+e.leftSE.point.x+", "+e.leftSE.point.y+"] -> ["+e.rightSE.point.x+", "+e.rightSE.point.y+"] failed. Please submit a bug report.")}}]),r(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isVertical",value:function(){return 0===(0,l.cmp)(this.leftSE.point.x,this.rightSE.point.x)}},{key:"isAnEndpoint",value:function(t){return 0===(0,l.cmpPoints)(t,this.leftSE.point)||0===(0,l.cmpPoints)(t,this.rightSE.point)}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.vector(),n=(0,s.perpendicular)(e),r=(0,s.intersection)(this.leftSE.point,e,t,n);return t.y<r.y?-1:t.y>r.y?1:t.x>r.x?-1:t.x<r.x?1:0}},{key:"touches",value:function(t){if(this.isAnEndpoint(t))return!0;var e=this.vector(),n=(0,s.perpendicular)(e),r=(0,s.intersection)(this.leftSE.point,e,t,n);return 0===(0,l.cmpPoints)(t,r)}},{key:"getIntersections",value:function(t){var e=(0,u.getBboxOverlap)(this.bbox(),t.bbox());if(null===e)return[];for(var n=[],r=(0,u.getUniqueCorners)(e),i=0,o=r.length;i<o;i++){var l=r[i];this.touches(l)&&t.touches(l)&&n.push(l)}if(0===n.length){var f=(0,s.intersection)(this.leftSE.point,this.vector(),t.leftSE.point,t.vector());null!==f&&(0,u.isInBbox)(e,f)&&n.push(f)}return n}},{key:"split",value:function(e){e.sort(l.cmpPoints);for(var n=this,r=null,i=[],u=0,s=e.length;u<s;u++){var f=e[u];if(!r||0!==(0,l.cmpPoints)(r,f)){var a=new o.default(f,!0),h=new o.default(f,!1),c=n.rightSE;n.replaceRightSE(h),i.push(h),i.push(a),n=new t(a,c,this.ringsIn.slice()),r=f}}return i}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=t.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}for(var u=0,l=r.ringsIn.length;u<l;u++)n.ringsIn.push(r.ringsIn[u]);r.ringsIn=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){var t="prevInResult";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_prevInResult",value:function(){return this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null}},{key:"ringsBefore",value:function(){var t="ringsBefore";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_ringsBefore",value:function(){return this.prev?(this.prev.consumedBy||this.prev).ringsAfter():[]}},{key:"ringsAfter",value:function(){var t="ringsAfter";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_ringsAfter",value:function(){for(var t=this.ringsBefore().slice(0),e=0,n=this.ringsIn.length;e<n;e++){var r=this.ringsIn[e],i=t.indexOf(r);-1===i?t.push(r):t.splice(i,1)}return t}},{key:"multiPolysBefore",value:function(){var t="multiPolysBefore";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_multiPolysBefore",value:function(){return this.prev?(this.prev.consumedBy||this.prev).multiPolysAfter():[]}},{key:"multiPolysAfter",value:function(){var t="multiPolysAfter";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_multiPolysAfter",value:function(){for(var t=[],e=[],n=this.ringsAfter(),r=0,i=n.length;r<i;r++){var o=n[r],u=o.poly;if(-1===e.indexOf(u))if(o.isExterior)t.push(u);else{-1===e.indexOf(u)&&e.push(u);var l=t.indexOf(o.poly);-1!==l&&t.splice(l,1)}}for(var s=[],f=0,a=t.length;f<a;f++){var h=t[f].multiPoly;-1===s.indexOf(h)&&s.push(h)}return s}},{key:"isInResult",value:function(){var t="isInResult";return void 0===this._cache[t]&&(this._cache[t]=this["_"+t]()),this._cache[t]}},{key:"_isInResult",value:function(){if(this.consumedBy)return!1;var t=this.multiPolysBefore(),e=this.multiPolysAfter();switch(i.default.type){case"union":return 0===t.length!==(0===e.length);case"intersection":var n=void 0,r=void 0;return t.length<e.length?(n=t.length,r=e.length):(n=e.length,r=t.length),r===i.default.numMultiPolys&&n<r;case"xor":return Math.abs(t.length-e.length)%2==1;case"difference":var o=function(t){return 1===t.length&&t[0].isSubject};return o(t)!==o(e);default:throw new Error("Unrecognized operation type found "+i.default.type)}}}],[{key:"fromRing",value:function(e,n,r){var i=void 0,u=void 0,s=(0,l.cmpPoints)(e,n);if(s<0)i=new o.default(e,!0),u=new o.default(n,!1);else{if(!(s>0))throw new Error("Tried to create degenerate segment at ["+e.x+", "+n.y+"]");i=new o.default(n,!0),u=new o.default(e,!1)}return new t(i,u,[r])}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function t(e,n){i(this,t),this.key=e,this.data=n,this.left=null,this.right=null};function u(t,e){return t>e?1:t<e?-1:0}function l(t,e,n){if(null===e)return e;var r=void 0,i=void 0,u=void 0,l=new o;for(r=i=l;;){var s=n(t,e.key);if(s<0){if(null===e.left)break;if(n(t,e.left.key)<0&&(u=e.left,e.left=u.right,u.right=e,null===(e=u).left))break;i.left=e,i=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(u=e.right,e.right=u.left,u.left=e,null===(e=u).right))break;r.right=e,r=e,e=e.right}}return r.right=e.left,i.left=e.right,e.left=l.right,e.right=l.left,e}function s(t,e,n,r,i){var u=new o(t,e);if(i._size++,null===n)return u.left=u.right=null,u;var s=r(t,(n=l(t,n,r)).key);return s<0?(u.left=n.left,u.right=n,n.left=null):s>=0&&(u.right=n.right,u.left=n,n.right=null),u}function f(t,e,n,r){var i=void 0;return null===e?null:0===n(t,(e=l(t,e,n)).key)?(null===e.left?i=e.right:(i=l(t,e.left,n)).right=e.right,r._size--,i):e}function a(t,e,n){var r=void 0,i=void 0;if(null===e)r=i=null;else{var o=n((e=l(t,e,n)).key,t);0===o?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}var h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;i(this,t),this._comparator=e,this._root=null,this._size=0}return r(t,[{key:"insert",value:function(t,e){return this._root=s(t,e,this._root,this._comparator,this)}},{key:"add",value:function(t,e){return this._root=function(t,e,n,r,i){var u=new o(t,e);if(null===n)return u.left=u.right=null,i._size++,u;var s=r(t,(n=l(t,n,r)).key);return 0===s?n:(s<0?(u.left=n.left,u.right=n,n.left=null):s>0&&(u.right=n.right,u.left=n,n.right=null),i._size++,u)}(t,e,this._root,this._comparator,this)}},{key:"remove",value:function(t){this._root=f(t,this._root,this._comparator,this)}},{key:"pop",value:function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=l(t.key,this._root,this._comparator),this._root=f(t.key,this._root,this._comparator,this),{key:t.key,data:t.data}}return null}},{key:"findStatic",value:function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null}},{key:"find",value:function(t){return this._root&&(this._root=l(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root}},{key:"contains",value:function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1}},{key:"forEach",value:function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this}},{key:"range",value:function(t,e,n,r){for(var i=[],o=this._comparator,u=this._root;0!==i.length||u;)if(u)i.push(u),u=u.left;else{if(o((u=i.pop()).key,e)>0)break;if(o(u.key,t)>=0&&n.call(r,u))return this;u=u.right}return this}},{key:"keys",value:function(){var t=[];return this.forEach(function(e){var n=e.key;return t.push(n)}),t}},{key:"values",value:function(){var t=[];return this.forEach(function(e){var n=e.data;return t.push(n)}),t}},{key:"min",value:function(){return this._root?this.minNode(this._root).key:null}},{key:"max",value:function(){return this._root?this.maxNode(this._root).key:null}},{key:"minNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.left;)t=t.left;return t}},{key:"maxNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.right;)t=t.right;return t}},{key:"at",value:function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null}},{key:"next",value:function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n}},{key:"prev",value:function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n}},{key:"clear",value:function(){return this._root=null,this._size=0,this}},{key:"toList",value:function(){return function(t){var e=t,n=[],r=!1,i={next:null},o=i;for(;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=o=o.next=n.pop()).right:r=!0;return o.next=null,i.next}(this._root)}},{key:"load",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.length,i=this._comparator;if(n&&function t(e,n,r,i,o){if(r>=i)return;var u=e[r+i>>1];var l=r-1;var s=i+1;for(;;){do{l++}while(o(e[l],u)<0);do{s--}while(o(e[s],u)>0);if(l>=s)break;var f=e[l];e[l]=e[s],e[s]=f,f=n[l],n[l]=n[s],n[s]=f}t(e,n,r,s,o);t(e,n,s+1,i,o)}(t,e,0,r-1,i),null===this._root)this._root=function t(e,n,r,i,o){var u=o-i;if(u>0){var l=i+Math.floor(u/2),s=n[l],f=r[l],a={key:s,data:f,parent:e};return a.left=t(a,n,r,i,l),a.right=t(a,n,r,l+1,o),a}return null}(this._root,t,e,0,r),this._size=r;else{var o=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){return t-e},r={},i=r,o=t,u=e;for(;null!==o&&null!==u;)n(o.key,u.key)<0?(i.next=o,o=o.next):(i.next=u,u=u.next),i=i.next;null!==o?i.next=o:null!==u&&(i.next=u);return r.next}(this.toList(),function(t,e){for(var n={next:null},r=n,i=0;i<t.length;i++)r=r.next={key:t[i],data:e[i]};return r.next=null,n.next}(t,e),i);r=this._size+r,this._root=function t(e,n,r){var i=r-n;if(i>0){var o=n+Math.floor(i/2),u=t(e,n,o),l=e.head;return l.left=u,e.head=e.head.next,l.right=t(e,o+1,r),l}return null}({head:o},0,r)}return this}},{key:"isEmpty",value:function(){return null===this._root}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t.key},e=[];return function t(e,n,r,i,o){if(e){i(n+(r?"└── ":"├── ")+o(e)+"\n");var u=n+(r?"    ":"│   ");e.left&&t(e.left,u,!1,i,o),e.right&&t(e.right,u,!0,i,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")}},{key:"update",value:function(t,e,n){var r=this._comparator,i=a(t,this._root,r),o=i.left,u=i.right;this._size--,r(t,e)<0?u=s(e,n,u,r,this):o=s(e,n,o,r,this),this._root=function(t,e,n){return null===e?t:null===t?e:((e=l(t.key,e,n)).left=t,e)}(o,u,r)}},{key:"split",value:function(t){return a(t,this._root,this._comparator)}},{key:"size",get:function(){return this._size}}]),t}();e.default=h,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Operation=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=h(n(4)),o=a(n(10)),u=a(n(9)),l=a(n(7)),s=h(n(1)),f=h(n(6));function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function h(t){return t&&t.__esModule?t:{default:t}}var c=new(e.Operation=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"run",value:function(t,e,n){c.type=t;for(var r=[o.pointsAsObjects(e)],a=0,h=n.length;a<h;a++)r.push(o.pointsAsObjects(n[a]));for(var p=0,v=r.length;p<v;p++)o.forceMultiPoly(r[p]),o.cleanMultiPoly(r[p]);for(var g=[],y=0,d=r.length;y<d;y++)g.push(new u.MultiPolyIn(r[y]));g[0].markAsSubject(),c.numMultiPolys=g.length;for(var m=new i.default(s.default.compare),x=0,_=g.length;x<_;x++)for(var E=g[x].getSweepEvents(),k=0,b=E.length;k<b;k++)m.insert(E[k]);for(var S=new f.default(m),w=void 0,P=m.size;w=m.pop();){var O=w.key;if(m.size===P)throw new Error("Unable to pop() SweepEvent #"+O.id+" ["+O.point.x+", "+O.point.y+"] from queue. Please file a bug report.");for(var R=S.process(O),A=0,I=R.length;A<I;A++)m.insert(R[A]);P=m.size}var M=l.RingOut.factory(S.segments);return new l.MultiPolyOut(M).getGeom()}}]),t}());e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=u(n(4)),o=u(n(3));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.compare;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.queue=e,this.tree=new i.default(n),this.segments=[]}return r(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft||this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #"+e.leftSE.id+" ["+e.leftSE.point.x+", "+e.leftSE.point.y+"] -> ["+e.rightSE.point.x+", "+e.rightSE.point.y+"] in SweepLine tree. Please submit a bug report.");var i=this.tree.prev(r),o=i?i.key:null,u=this.tree.next(r),l=u?u.key:null;if(t.isLeft){var s=[];if(o){var f=o.getIntersections(e);if(f.length>0){for(var a=this._possibleSplit(o,f),h=0,c=a.length;h<c;h++)n.push(a[h]);for(var p=0,v=f.length;p<v;p++){var g=f[p];e.isAnEndpoint(g)||s.push(g)}}}if(l){var y=l.getIntersections(e);if(y.length>0){for(var d=this._possibleSplit(l,y),m=0,x=d.length;m<x;m++)n.push(d[m]);for(var _=0,E=y.length;_<E;_++){var k=y[_];e.isAnEndpoint(k)||s.push(k)}}}if(n.length>0||s.length>0){if(this.tree.remove(e),this.queue.remove(e.rightSE),n.push(e.rightSE),s.length>0)for(var b=e.split(s),S=0,w=b.length;S<w;S++)n.push(b[S]);n.push(t)}else this.segments.push(e),e.prev=o}else{if(o&&l){var P=o.getIntersections(l);if(P.length>0){for(var O=this._possibleSplit(o,P),R=0,A=O.length;R<A;R++)n.push(O[R]);for(var I=0,M=(O=this._possibleSplit(l,P)).length;I<M;I++)n.push(O[I])}}this.tree.remove(e)}return n}},{key:"_possibleSplit",value:function(t,e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t.isAnEndpoint(o)||n.push(o)}var u=[];if(n.length>0){this.tree.remove(t);var l=t.rightSE;this.queue.remove(l),(u=t.split(n)).push(l),this.tree.insert(t)}return u}}]),t}();e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiPolyOut=e.PolyOut=e.RingOut=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),u=n(1),l=(r=u)&&r.__esModule?r:{default:r};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.RingOut=function(){function t(e){s(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return i(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];if(o.isInResult()&&!o.ringOut){for(var u=null,l=o.leftSE,s=o.rightSE,f=[l],a=l.point,h=[];u=l,l=s,f.push(l),l.point!==a;)for(;;){var c=l.getAvailableLinkedEvents();if(0===c.length){var p=f[0].point,v=f[f.length-1].point;throw new Error("Unable to complete output ring starting at ["+p.x+", "+p.y+"]. Last matching segment found ends at ["+v.x+", "+v.y+"].")}if(1===c.length){s=c[0].otherSE;break}for(var g=null,y=0,d=h.length;y<d;y++)if(h[y].point===l.point){g=y;break}if(null===g){h.push({index:f.length,point:l.point});var m=l.getLeftmostComparator(u);s=c.sort(m)[0].otherSE;break}var x=h.splice(g)[0],_=f.splice(x.index);_.unshift(_[0].otherSE),n.push(new t(_.reverse()))}n.push(new t(f))}}return n}}]),i(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,u=this.events[n+1].point;0!==(0,o.compareVectorAngles)(i,t,u)&&(e.push(i),t=i)}if(1===e.length)return null;var l=e[0],s=e[1];0===(0,o.compareVectorAngles)(l,t,s)&&e.shift(),e.push(e[0]);for(var f=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,c=[],p=a;p!=h;p+=f)c.push([e[p].x,e[p].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];l.default.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),t}();var f=e.PolyOut=function(){function t(e){s(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return i(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),t}();e.MultiPolyOut=function(){function t(e){s(this,t),this.rings=e,this.polys=this._composePolys(e)}return i(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new f(i));else{var o=i.enclosingRing();o.poly||e.push(new f(o)),o.poly.addInterior(i)}}return e}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getUniqueCorners=e.getBboxOverlap=e.doBboxesOverlap=e.isInBbox=void 0;var r=n(0),i=(e.isInBbox=function(t,e){var n=t.ll.x,i=t.ll.y,o=t.ur.x,u=t.ur.y,l=e.x,s=e.y;return(0,r.cmp)(n,l)<=0&&(0,r.cmp)(l,o)<=0&&(0,r.cmp)(i,s)<=0&&(0,r.cmp)(s,u)<=0},e.doBboxesOverlap=function(t,e){return!((0,r.cmp)(e.ur.x,t.ll.x)<0||(0,r.cmp)(t.ur.x,e.ll.x)<0||(0,r.cmp)(e.ur.y,t.ll.y)<0||(0,r.cmp)(t.ur.y,e.ll.y)<0)});e.getBboxOverlap=function(t,e){if(!i(t,e))return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},e.getUniqueCorners=function(t){var e=t.ll.x,n=t.ll.y,i=t.ur.x,o=t.ur.y,u=0===(0,r.cmp)(e,i),l=0===(0,r.cmp)(n,o);return u||l?u&&!l?[{x:e,y:n},{x:e,y:o}]:!u&&l?[{x:e,y:n},{x:i,y:n}]:[{x:e,y:n}]:[{x:e,y:n},{x:e,y:o},{x:i,y:n},{x:i,y:o}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiPolyIn=e.PolyIn=e.RingIn=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=o(n(3));o(n(1));function o(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=e.RingIn=function(){function t(e,n,r){u(this,t),this.poly=n,this.isExterior=r,this.segments=[];for(var o=e[0],l=1,s=e.length;l<s;l++){var f=e[l];this.segments.push(i.default.fromRing(o,f,this)),o=f}this.segments.push(i.default.fromRing(o,e[0],this))}return r(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),t}(),s=e.PolyIn=function(){function t(e,n){u(this,t),this.exteriorRing=new l(e[0],this,!0),this.interiorRings=[];for(var r=1,i=e.length;r<i;r++)this.interiorRings.push(new l(e[r],this,!1));this.multiPoly=n}return r(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}();e.MultiPolyIn=function(){function t(e){u(this,t),this.polys=[];for(var n=0,r=e.length;n<r;n++)this.polys.push(new s(e[n],this));this.isSubject=!1}return r(t,[{key:"markAsSubject",value:function(){this.isSubject=!0}},{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cleanRing=e.cleanMultiPoly=e.forceMultiPoly=e.pointsAsObjects=void 0;var r=n(0),i=n(2),o=(e.pointsAsObjects=function(t){var e=[];if(!Array.isArray(t))throw new Error("Input is not a Polygon or MultiPolygon");for(var n=0,r=t.length;n<r;n++){if(!Array.isArray(t[n])||0==t[n].length)throw new Error("Input is not a Polygon or MultiPolygon");e.push([]);for(var i=0,o=t[n].length;i<o;i++){if(!Array.isArray(t[n][i])||0==t[n][i].length)throw new Error("Input is not a Polygon or MultiPolygon");if(Array.isArray(t[n][i][0])){e[n].push([]);for(var u=0,l=t[n][i].length;u<l;u++){if(!Array.isArray(t[n][i][u])||t[n][i][u].length<2)throw new Error("Input is not a Polygon or MultiPolygon");if(t[n][i][u].length>2)throw new Error("Input has more than two coordinates. Only 2-dimensional polygons supported.");e[n][i].push({x:t[n][i][u][0],y:t[n][i][u][1]})}}else{if(t[n][i].length<2)throw new Error("Input is not a Polygon or MultiPolygon");if(t[n][i].length>2)throw new Error("Input has more than two coordinates. Only 2-dimensional polygons supported.");e[n].push({x:t[n][i][0],y:t[n][i][1]})}}}return e},e.forceMultiPoly=function(t){if(Array.isArray(t)){if(0===t.length)return;if(Array.isArray(t[0])){if(Array.isArray(t[0][0])&&"number"==typeof t[0][0][0].x&&"number"==typeof t[0][0][0].y)return;if("number"==typeof t[0][0].x&&"number"==typeof t[0][0].y)return void t.unshift(t.splice(0))}}throw new Error("Unrecognized input - not a polygon nor multipolygon")},e.cleanMultiPoly=function(t){for(var e=0;e<t.length;){var n=t[e];if(0!==n.length){var r=n[0];if(o(r),0!==r.length){for(var i=1;i<n.length;){var u=n[i];o(u),0===u.length?n.splice(i,1):i++}e++}else t.splice(e,1)}else t.splice(e,1)}},e.cleanRing=function(t){if(0!==t.length){0===(0,r.cmpPoints)(t[0],t[t.length-1])&&t.pop();for(var e=function(t,e,n){return 0===(0,r.cmpPoints)(t,e)||0===(0,r.cmpPoints)(e,n)||0===(0,i.compareVectorAngles)(e,t,n)},n=0,o=void 0,u=void 0;n<t.length;)o=0===n?t[t.length-1]:t[n-1],u=n===t.length-1?t[0]:t[n+1],e(o,t[n],u)?t.splice(n,1):n++;for(;t.length<3&&t.length>0;)t.pop()}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(5),o=(r=i)&&r.__esModule?r:{default:r};e.default={union:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return o.default.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return o.default.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return o.default.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return o.default.run("difference",t,n)}},t.exports=e.default}])});